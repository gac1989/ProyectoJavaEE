<!DOCTYPE HTML>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf">
<h:head>
	<meta charset="utf-8" name="viewport"
		content="width=device-width, initial-scale=1"
		http-equiv="X-UA-Conpatible" />
	<title>Nuevo juego</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
	<script>
      $(document).ready(function() {
        // Gets the span width of the filled-ratings span
        // this will be the same for each rating
        var star_rating_width = $('.fill-ratings span').width();
        // Sets the container of the ratings to span width
        // thus the percentages in mobile will never be wrong
        $('.star-ratings').width(star_rating_width);
      });
    </script>
    <style>
	      .star-ratings {
	        unicode-bidi: bidi-override;
	        color: #ccc;
	        font-size: 64px;
	        position: relative;
	        margin: 0;
	        padding: 0;
	      }
	      .fill-ratings {
	        color: #e7711b;
	        padding: 0;
	        position: absolute;
	        z-index: 1;
	        display: block;
	        top: 0;
	        left: 0;
	        overflow: hidden;
	      }
	      span {
	        display: inline-block;
	      }
	      .empty-ratings {
	        padding: 0;
	        display: block;
	        z-index: 0;
	      }
    
		img {
			height: 250px;
			width: 400px;
			object-fit: cover;
		}
			
	      body {
	        margin-top: 50px;
	        font-family: sans-serif;
	        background: #f1f1f1;
	      }
	
	      table {
	        margin: 0 auto;
	        text-align: center;
	        border-collapse: collapse;
	        border: 1px solid #d4d4d4;
	        font-size: 20px;
	        background: #fff;
	      }
	
	      table th,
	      table tr:nth-child(2n + 2) {
	        background: #e7e7e7;
	      }
	
	      table th,
	      table td {
	        padding: 20px 50px;
	      }
	
	      table th {
	        border-bottom: 1px solid #d4d4d4;
	      }
	
	      .stars-outer {
	        display: inline-block;
	        position: relative;
	        font-family: FontAwesome;
	      }
	
	      .stars-outer::before {
	        content: "\f006 \f006 \f006 \f006 \f006";
	      }
	
	      .stars-inner {
	        position: absolute;
	        top: 0;
	        left: 0;
	        white-space: nowrap;
	        overflow: hidden;
	        width: 0;
	      }
	
	      .stars-inner::before {
	        content: "\f005 \f005 \f005 \f005 \f005";
	        color: #f8ce0b;
	      }
	
	      .attribution {
	        font-size: 12px;
	        color: #444;
	        text-decoration: none;
	        text-align: center;
	        position: fixed;
	        right: 10px;
	        bottom: 10px;
	        z-index: -1;
	      }
	      .attribution:hover {
	        color: #1fa67a;
	      }
	      .oferta{
				color: orange;
			}
			.antes{
				color: red;
				text-decoration: line-through;
			}
			.despues{
				color:green;		
			}
			.titulo{
				color: #17a2b8;
				text-decoration: none;
			}
    </style>
</h:head>
<h:body>
	<ui:include src="./navBar.xhtml" />	
 	<div class="container">
           <div class="row">
               <div class="col-lg-3">
                   <h1 class="my-4">Steamindie</h1>
                   <div class="list-group">
                       <a class="list-group-item active" href="#!">Category 1</a>
                       <a class="list-group-item" href="#!">Category 2</a>
                       <a class="list-group-item" href="#!">Category 3</a>
                   </div>
               </div>
               <div class="col-lg-9">
                   <div class="card mt-4">
                   <img class="img-fluid" src="http://localhost:8080/rest-lab/api/ejemplo/descarga/#{perfil.rutaImg}" alt="..." />
                       <div class="card-body">
                       	<h2 class="titulo">#{perfil.nombre}</h2>
                        <h5 class="oferta" jsf:rendered="#{perfil.evento!=null}">Oferta #{perfil.evento.nombre}!!</h5>
					    <h6 jsf:rendered="#{perfil.evento==null}">Precio: #{perfil.precio}</h6>
					    <h6 class="antes" jsf:rendered="#{perfil.evento!=null}">Precio antes: #{perfil.precio}</h6>
					    <h6 class="despues" jsf:rendered="#{perfil.evento!=null}"> Precio en oferta!! U$S #{perfil.precio-(perfil.precio*perfil.evento.descuento)/100}</h6>
				     	<h6 class="despues" jsf:rendered="#{perfil.evento!=null}">#{perfil.evento.descuento}% de descuento!</h6>
			     	  	
                           <h:form>
                           		<input type='hidden' name='cancel_return' value="#{ComentarioBean.juegoComprado(perfil.id)}"></input>
					    		<h:commandButton action="#{ComprarJuego.buscarJuego(perfil)}" value="Comprar" class="btn btn-primary" rendered="#{type == 'jugador' and  ComentarioBean.done2 eq false}"></h:commandButton>
						    	<h:panelGroup layout="block" rendered="#{type == 'jugador' and  ComentarioBean.done eq true}" class="alert alert-success">Ya ha comprado este juego</h:panelGroup>
					  		</h:form>
					  		<div class="star-ratings">
						      <div class="fill-ratings" style="width: #{perfil.nota*100/5}%;">
						        <span>ðŸŸŠðŸŸŠðŸŸŠðŸŸŠðŸŸŠ</span>
						      </div>
						      <div class="empty-ratings">
						        <span>ðŸŸŠðŸŸŠðŸŸŠðŸŸŠðŸŸŠ</span>
						      </div>
						    </div>
					       <div class="card card-outline-secondary my-4">
		                       <div class="card-header">Descripcion:</div>
		                       <div class="card-body">
		                       		 #{perfil.descripcion}
		                       </div>
	                       	</div>
                       </div>
                   </div>
                   <div class="card card-outline-secondary my-4">
                       <div class="card-header">Product Reviews</div>
                       <div class="card-body">
                       
                    		<c:forEach items="#{ComentarioBean.obtenerComentarios(perfil.id)}" var="c">
                    			<p>#{c.texto} - #{c.nota}</p>
                          		<small class="text-muted">Posted by #{c.autor.nick}</small>
                          		<hr />
                           </c:forEach>
                           <h:form>
	                           <h:panelGroup rendered="#{type == 'jugador'}">
		                           	<p:inputNumber id="input1" value="#{ComentarioBean.nota}" modifyValueOnWheel="false" maxValue="5" minValue="1" rendered="#{ComentarioBean.done eq true}"/>
		                           	<br></br>
		                           	<br></br>
		                          	 <h:inputText id="username" value="#{ComentarioBean.texto}" class="form-control" rendered="#{ComentarioBean.done eq true}"></h:inputText>
		                           	<br></br>
		                          	<h:commandButton  action="#{ComentarioBean.publicarComentario(ComentarioBean.texto, perfil.id, ComentarioBean.nota)}" value="Publicar" class="btn btn-success" rendered="#{ComentarioBean.done==true}"/>
	                      		</h:panelGroup>
                     		</h:form>
                       </div>
                   </div>
               </div>
           </div>
       </div>
</h:body>
</html>